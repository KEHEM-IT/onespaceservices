<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>One-Reach Services - Your One Stop Solution for Land, Living, and Lifestyle</title>
    <link rel="icon" type="image/x-icon" href="https://kehem.com/static/kehem.webp">
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Fontawesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Toastify CSS + JS CDN -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0048a7',
                        secondary: '#85ffff',
                        darkPrimary: '#00306e',
                        litePrimary: '#0063e4',
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-up': 'slideUp 0.6s ease-out',
                        'bounce-subtle': 'bounceSubtle 2s infinite',
                        'pulse-glow': 'pulseGlow 2s ease-in-out infinite alternate',
                    }
                }
            }
        }
    </script>

    <style>
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes bounceSubtle {

            0%,
            100% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(-5px);
            }
        }

        @keyframes pulseGlow {
            0% {
                box-shadow: 0 0 20px rgba(0, 72, 167, 0.3);
            }

            100% {
                box-shadow: 0 0 30px rgba(0, 72, 167, 0.6);
            }
        }

        .glass-morphism {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .input-floating:focus+label,
        .input-floating:not(:placeholder-shown)+label {
            transform: translateY(-35px) scale(0.8);
            color: #0048a7;
            background: white;
            padding: 0 4px;
            border-radius: 4px;
        }

        .input-floating+label {
            transition: all 0.2s ease-in-out;
            transform-origin: left top;
        }

        .gradient-bg {
            background: linear-gradient(135deg, #0048a7 0%, #0063e4 50%, #85ffff 100%);
        }

        .loading {
            pointer-events: none;
            opacity: 0.7;
        }

        .spinner {
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<main class="flex items-center justify-center min-h-screen">
    <div class="w-full max-w-md mx-auto shadow-2xl rounded-3xl p-8 animate-fade-in border">
        <h2 class="text-2xl font-bold text-gray-800 text-center mb-8">Login</h2>

        <form id="loginForm" class="space-y-8">
            <!-- Email Field -->
            <div class="relative">
                <input type="email" id="email" name="email" required placeholder=" "
                    class="input-floating w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-primary transition-all duration-300 bg-white/80 peer">
                <label for="email"
                    class="absolute left-4 top-3 text-gray-500 transition-all duration-300 pointer-events-none">
                    Email Address <span class="text-red-500">*</span>
                </label>
                <div class="absolute right-3 top-3 text-gray-400">
                    <i class="fas fa-envelope"></i>
                </div>
            </div>

            <!-- Phone Field -->
            <div class="relative">
                <input type="tel" id="phone" name="phone" required placeholder=" "
                    class="input-floating w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-primary transition-all duration-300 bg-white/80 peer">
                <label for="phone"
                    class="absolute left-4 top-3 text-gray-500 transition-all duration-300 pointer-events-none">
                    Phone Number <span class="text-red-500">*</span>
                </label>
                <div class="absolute right-3 top-3 text-gray-400">
                    <i class="fas fa-phone"></i>
                </div>
            </div>

            <!-- Remember Me -->
            <div class="flex items-center justify-between">
                <label class="flex items-center space-x-2 cursor-pointer">
                    <input type="checkbox"
                        class="w-4 h-4 text-primary bg-gray-100 border-gray-300 rounded focus:ring-primary">
                    <span class="text-sm text-gray-600">Remember me</span>
                </label>
            </div>

            <!-- Submit Button -->
            <button type="submit" id="loginBtn"
                class="w-full py-3 bg-primary text-white rounded-xl hover:bg-darkPrimary transition-all duration-300 font-medium text-lg shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 active:translate-y-0">
                <span id="btnText">Sign In</span>
                <i id="btnSpinner" class="fas fa-spinner spinner hidden ml-2"></i>
            </button>
        </form>



        <!-- Register Link -->
        <p class="text-sm text-gray-600 text-center mt-4">
            Don't have an account?
            <a href="register.html"
                class="text-primary font-medium hover:text-darkPrimary transition-colors hover:underline">
                Create Account
            </a>
        </p>

    </div>
</main>

<script>

    const savedUser = JSON.parse(localStorage.getItem("userData"));
    console.log(savedUser);

    if (savedUser !== null) {
        window.location.href = window.referrer || '/';
    }

    // Toast utility functions
    function showToast(message, type = 'success') {
        const colors = {
            success: "linear-gradient(to right, #00b09b, #96c93d)",
            error: "linear-gradient(to right, #ff416c, #ff4b2b)",
            info: "linear-gradient(to right, #0048a7, #0063e4)",
            warning: "linear-gradient(to right, #f093fb, #f5576c)"
        };

        Toastify({
            text: message,
            duration: 4000,
            gravity: "top",
            position: "right",
            stopOnFocus: true,
            style: {
                background: colors[type] || colors.info,
                borderRadius: "10px",
                fontSize: "14px",
                fontWeight: "500",
                boxShadow: "0 10px 30px rgba(0,0,0,0.2)"
            },
            onClick: function () {
                this.hideToast();
            }
        }).showToast();
    }

    // Form validation
    function validateForm(formData) {
        const email = formData.get('email');
        const phone = formData.get('phone');

        if (!email || !email.includes('@')) {
            showToast('Please enter a valid email address', 'error');
            return false;
        }

        if (!phone || phone.length < 10) {
            showToast('Please enter a valid phone number', 'error');
            return false;
        }

        return true;
    }

    // Loading state management
    function setLoadingState(loading) {
        const form = document.getElementById('loginForm');
        const btn = document.getElementById('loginBtn');
        const btnText = document.getElementById('btnText');
        const btnSpinner = document.getElementById('btnSpinner');

        if (loading) {
            form.classList.add('loading');
            btn.disabled = true;
            btn.classList.add('opacity-75', 'cursor-not-allowed');
            btnText.textContent = 'Signing in...';
            btnSpinner.classList.remove('hidden');
        } else {
            form.classList.remove('loading');
            btn.disabled = false;
            btn.classList.remove('opacity-75', 'cursor-not-allowed');
            btnText.textContent = 'Sign In';
            btnSpinner.classList.add('hidden');
        }
    }

    // Form submission
    document.getElementById('loginForm').addEventListener('submit', async function (e) {
        e.preventDefault();

        const formData = new FormData(this);

        // Validate form
        if (!validateForm(formData)) {
            return;
        }

        // Show loading state
        setLoadingState(true);
        showToast('Processing your login...', 'info');

        try {
            const response = await fetch('https://onereachservices.com/login/', {
                method: 'POST',
                body: formData,
                headers: {
                    'X-Requested-With': 'XMLHttpRequest'
                }
            });

            if (response.ok) {

                localStorage.setItem("userData", JSON.stringify(response));
                showToast('Login successful! Welcome back!', 'success');

                // Redirect after 2 seconds
                setTimeout(() => {
                    window.location.href = document.referrer || '/';
                }, 2000);

            } else if (response.status === 401) {
                showToast('Invalid credentials. Please check your email and phone number.', 'error');
            } else if (response.status === 429) {
                showToast('Too many login attempts. Please try again later.', 'warning');
            } else {
                showToast('Login failed. Please try again.', 'error');
            }

        } catch (error) {
            console.error('Login error:', error);
            showToast('Network error. Please check your connection and try again.', 'error');
        } finally {
            setLoadingState(false);
        }
    });

    // Input focus effects
    document.querySelectorAll('.input-floating').forEach(input => {
        input.addEventListener('focus', function () {
            this.parentElement.classList.add('ring-2', 'ring-primary', 'ring-opacity-20');
        });

        input.addEventListener('blur', function () {
            this.parentElement.classList.remove('ring-2', 'ring-primary', 'ring-opacity-20');
        });
    });



</script>

</html>